/* =========================================
   1. CORE VARIABLES & RESET
   ========================================= */
:root {
    /* Brand Colors */
    --brand-green: #a6cf39;
    --brand-green-dark: #7ca323;
    --brand-dark: #0f172a;
    --brand-gray: #64748b;
    --brand-bg: #f8fafc;
    --brand-surface: #ffffff;

    /* AERO Edition Variables */
    --surface-glass: rgba(255, 255, 255, 0.75);
    
    /* Dimensions - REDUCED FOR BETTER MOBILE VIEW */
    --header-height: 72px;
    --bottom-nav-height: 68px; /* Reduced from 84px */
    
    /* Shadows */
    --shadow-subtle: 0 2px 10px rgba(0,0,0,0.03);
    --shadow-card: 0 10px 30px -5px rgba(166, 207, 57, 0.15);
    --shadow-float: 0 20px 40px -5px rgba(0, 0, 0, 0.05);
}

html, body {
    height: 100%;
    background-color: var(--brand-bg);
    font-family: "Inter", system-ui, -apple-system, sans-serif;
    color: var(--brand-dark);
    -webkit-font-smoothing: antialiased;
    -webkit-tap-highlight-color: transparent;
}

/* CRITICAL LAYOUT FIX */
body {
    padding-top: var(--header-height);
    /* Mobile bottom padding INCREASED to ensure content is visible above nav */
    padding-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 20px); 
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* Ensures main content pushes footer down */
main {
    flex: 1 0 auto;
    width: 100%;
    display: flex;
    flex-direction: column;
}

@media (min-width: 992px) {
    body { padding-bottom: 0; }
}

/* Global Resets */
a, .nav-link, .btn-link, .dropdown-item { text-decoration: none !important; }
ul { list-style: none; padding: 0; margin: 0; }

/* Animations */
.fade-in { animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}
.fade-in-item {
    animation: fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

@keyframes pulse-green {
    0% { box-shadow: 0 0 0 0 rgba(166, 207, 57, 0.7); }
    70% { box-shadow: 0 0 0 8px rgba(166, 207, 57, 0); }
    100% { box-shadow: 0 0 0 0 rgba(166, 207, 57, 0); }
}
.pulse-animation {
    border-radius: 50%;
    animation: pulse-green 2s infinite;
}

/* GEMINI GLOW ANIMATION (New) */
@keyframes gemini-glow {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* =========================================
   2. NAVIGATION & HEADER
   ========================================= */
.desktop-header {
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    height: var(--header-height);
    position: fixed; top: 0; left: 0; right: 0;
    z-index: 1030;
    transition: all 0.3s ease;
}

.nav-link-modern {
    position: relative;
    display: flex; align-items: center; gap: 8px;
    padding: 0.6rem 1rem; margin: 0 2px;
    font-size: 0.9rem; font-weight: 600; color: var(--brand-gray);
    border-radius: 12px; 
    transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    background: transparent; border: 1px solid transparent;
}
.nav-link-modern i { font-size: 1.1rem; color: #94a3b8; transition: color 0.2s; }

.nav-link-modern:hover {
    background: rgba(255, 255, 255, 0.8);
    color: var(--brand-dark);
    transform: translateY(-2px); 
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}
.nav-link-modern:hover i { color: var(--brand-green); }

/* GEMINI STYLE ACTIVE STATE (Desktop) */
.nav-link-modern.active {
    background: linear-gradient(90deg, var(--brand-green), #d9f99d, var(--brand-green));
    background-size: 200% 200%;
    animation: gemini-glow 3s ease infinite;
    color: #fff;
    box-shadow: 0 4px 20px rgba(166, 207, 57, 0.5);
    border: none;
}
.nav-link-modern.active i { color: #fff; }

/* Mobile Bottom Nav */
.mobile-bottom-nav {
    display: none;
    position: fixed; bottom: 0; left: 0; right: 0;
    background: rgba(255, 255, 255, 0.96);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid rgba(0,0,0,0.05);
    height: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom));
    padding-bottom: env(safe-area-inset-bottom);
    z-index: 1040;
    box-shadow: 0 -5px 25px rgba(0,0,0,0.03);
    padding-left: 1rem; padding-right: 1rem;
    justify-content: space-between; align-items: center;
}
.nav-item-mobile {
    flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
    color: #94a3b8; text-decoration: none;
    font-size: 0.65rem; /* Slightly smaller text for new height */
    font-weight: 600; transition: all 0.2s; height: 100%;
}
.nav-item-mobile i { font-size: 1.5rem; margin-bottom: 2px; transition: transform 0.2s; }
.nav-item-mobile.active { color: var(--brand-dark); }

/* Gemini Glow for Mobile Icon */
.nav-item-mobile.active i { 
    color: var(--brand-green); 
    transform: translateY(-2px); 
    text-shadow: 0 0 15px rgba(166, 207, 57, 0.6);
}

/* CYBERPUNK SCAN BUTTON (Restored) */
.fab-scan-container {
    position: fixed;
    bottom: calc(var(--bottom-nav-height) + 15px); /* Floats just above bottom nav */
    left: 50%;
    transform: translateX(-50%);
    z-index: 1050;
    display: none; /* Controlled by media query */
}

.fab-scan {
    width: 64px;
    height: 64px;
    background: #0f172a; /* Deep cyberpunk dark */
    border: 2px solid var(--brand-green);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--brand-green);
    font-size: 1.8rem;
    box-shadow: 0 0 20px rgba(166, 207, 57, 0.5), inset 0 0 10px rgba(166, 207, 57, 0.2);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    animation: pulse-green 3s infinite;
}

.fab-scan:active {
    transform: scale(0.9);
    background: var(--brand-green);
    color: #fff;
    box-shadow: 0 0 30px rgba(166, 207, 57, 0.8);
}

/* Offcanvas Mobile */
.offcanvas-custom {
    border-top-left-radius: 24px; border-bottom-left-radius: 24px;
    background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(15px);
}
.mobile-menu-link {
    padding: 1rem; border-radius: 12px; font-weight: 600; color: var(--brand-dark);
    display: flex; align-items: center; gap: 12px; transition: background 0.2s;
}
.mobile-menu-link:active { background-color: #f1f5f9; }
.mobile-menu-link.active { background-color: rgba(166, 207, 57, 0.15); color: var(--brand-green-dark); }

/* =========================================
   3. CORE COMPONENTS (Buttons, Cards, Toasts)
   ========================================= */

/* The "Scan/New" Button (Neon Glow) */
.btn-brand-new {
    background: linear-gradient(135deg, #a6cf39 0%, #7ca323 100%);
    color: #fff !important;
    border: none;
    border-radius: 10px;
    padding: 0.6rem 1.5rem;
    font-weight: 600;
    box-shadow: 0 4px 6px rgba(166, 207, 57, 0.3);
    transition: all 0.3s ease;
}
.btn-brand-new:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(166, 207, 57, 0.6);
}

/* The "Preview" Button */
.btn-preview {
    background: #f8fafc;
    color: #64748b;
    border: 1px solid #e2e8f0;
    border-radius: 10px;
    font-weight: 600;
    font-size: 0.85rem;
    padding: 0.6rem 1rem;
    transition: all 0.2s ease;
}
.btn-preview:hover {
    background: #fff;
    color: #0f172a;
    border-color: #cbd5e1;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    transform: translateY(-1px);
}

/* The Modern Card (With Deep Shadow & Glow on Hover) */
.modern-card, .card {
    background: #fff;
    border: 1px solid rgba(0,0,0,0.04);
    border-radius: 16px;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
    display: flex; flex-direction: column;
}
.modern-card:hover, .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.12), 0 10px 15px -5px rgba(0, 0, 0, 0.05);
    border-color: rgba(166, 207, 57, 0.5); /* Green border glow */
}

/* Toasts */
.toast-container-custom {
    position: fixed; top: 20px; left: 50%; transform: translateX(-50%); 
    z-index: 2060; width: 90%; max-width: 400px; pointer-events: none; 
}
.toast-modern {
    background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
    border: 1px solid rgba(0,0,0,0.05); border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 10px; pointer-events: auto;
}

/* Footer */
.main-footer {
    flex-shrink: 0; /* Prevents shrinking */
    padding: 2rem 0;
    border-top: 1px solid rgba(0,0,0,0.05);
    background: #fff; color: #94a3b8; font-size: 0.85rem;
    position: relative;
    z-index: 10;
}

/* =========================================
   4. DASHBOARD & HERO (INDEX PAGE)
   ========================================= */
.hero-glass {
    background: linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,250,252,0.9) 100%);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 28px;
    padding: 3rem;
    border: 1px solid rgba(255,255,255,0.5);
    box-shadow: 0 20px 50px rgba(0,0,0,0.05);
    position: relative;
    overflow: hidden;
    margin-bottom: 3rem;
    z-index: 1;
}
.orb {
    position: absolute; border-radius: 50%; filter: blur(60px); z-index: -1; opacity: 0.6;
    animation: float 8s ease-in-out infinite;
}
.orb-1 { width: 300px; height: 300px; background: rgba(166, 207, 57, 0.2); top: -50px; right: -50px; }
.orb-2 { width: 200px; height: 200px; background: rgba(59, 130, 246, 0.15); bottom: -20px; left: 10%; animation-delay: 2s; }
@keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

.hero-title {
    font-size: 2.5rem; font-weight: 800; letter-spacing: -0.03em; line-height: 1.1; margin-bottom: 0.5rem;
    background: linear-gradient(90deg, #0f172a 0%, #334155 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}

.btn-glass-action {
    background: rgba(255,255,255,0.7); border: 1px solid rgba(0,0,0,0.05);
    color: #0f172a; font-weight: 700; padding: 1rem 1.5rem; border-radius: 16px;
    display: flex; align-items: center; gap: 10px; transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(0,0,0,0.03);
}
.btn-glass-action:hover {
    transform: translateY(-3px); background: #fff;
    box-shadow: 0 10px 25px rgba(0,0,0,0.08); color: var(--brand-green-dark);
}

.module-card {
    background: #fff; border-radius: 20px; padding: 1.25rem; height: 100%;
    border: 1px solid rgba(0,0,0,0.03); box-shadow: 0 4px 10px rgba(0,0,0,0.02);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    display: flex; align-items: center; gap: 1rem;
}
.module-card:hover {
    transform: translateY(-5px); box-shadow: 0 15px 35px rgba(0,0,0,0.08);
    border-color: rgba(166, 207, 57, 0.4);
}
.module-icon {
    width: 56px; height: 56px; border-radius: 14px;
    display: flex; align-items: center; justify-content: center;
    font-size: 1.6rem; transition: transform 0.3s;
}
.module-card:hover .module-icon { transform: scale(1.1) rotate(5deg); }

.icon-blue { background: #eff6ff; color: #3b82f6; }
.icon-green { background: #f0fdf4; color: #16a34a; }
.icon-orange { background: #fff7ed; color: #f97316; }
.icon-purple { background: #faf5ff; color: #a855f7; }
.icon-gray { background: #f8fafc; color: #64748b; }

.module-text h5 { font-size: 1rem; font-weight: 700; color: #1e293b; margin: 0; }
.module-text span { font-size: 0.8rem; color: #94a3b8; }

.stats-widget {
    background: rgba(255,255,255,0.6); border-radius: 20px; padding: 1.5rem;
    border: 1px solid rgba(255,255,255,0.8); text-align: center; height: 100%;
    display: flex; flex-direction: column; justify-content: center;
}
.stat-big { font-size: 2.5rem; font-weight: 800; color: #0f172a; line-height: 1; }
.stat-desc { font-size: 0.75rem; text-transform: uppercase; color: #64748b; font-weight: 700; margin-top: 5px; }
.sec-label {
    font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em;
    color: #94a3b8; font-weight: 800; margin-bottom: 1rem; display: flex; align-items: center; gap: 8px;
}
.sec-line { height: 1px; background: #e2e8f0; flex-grow: 1; }

/* =========================================
   5. PRODUCT CATALOG "AERO" STYLES
   ========================================= */

/* Toolbar */
.catalog-toolbar {
    background: #fff;
    border-radius: 16px;
    padding: 1rem;
    box-shadow: var(--shadow-subtle);
    border: 1px solid rgba(0,0,0,0.03);
    margin-bottom: 2rem;
    display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;
}

/* Product Card */
.prod-card {
    background: #fff;
    border-radius: 20px;
    border: 1px solid rgba(0,0,0,0.04);
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    height: 100%;
    display: flex; flex-direction: column; position: relative;
}
.prod-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.08);
    border-color: rgba(166, 207, 57, 0.3);
}

.prod-img-box {
    height: 220px; background: #f8fafc;
    display: flex; align-items: center; justify-content: center;
    position: relative; overflow: hidden;
}
.prod-img {
    max-height: 80%; max-width: 80%; object-fit: contain;
    mix-blend-mode: multiply; transition: transform 0.5s ease;
}
.prod-card:hover .prod-img { transform: scale(1.1); }

.prod-badges {
    position: absolute; top: 12px; left: 12px;
    display: flex; flex-direction: column; gap: 6px; z-index: 2;
}
.badge-tag {
    padding: 4px 10px; border-radius: 50rem; font-size: 0.65rem;
    font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
.tag-promo { background: #fff; color: #ef4444; }
.tag-new { background: var(--brand-green); color: #fff; }

.prod-body { padding: 1.25rem; flex-grow: 1; display: flex; flex-direction: column; }
.prod-brand { font-size: 0.7rem; text-transform: uppercase; color: #94a3b8; font-weight: 700; letter-spacing: 0.05em; margin-bottom: 4px; }
.prod-title {
    font-size: 1rem; font-weight: 700; color: var(--brand-dark); line-height: 1.4;
    margin-bottom: 0.5rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
    overflow: hidden; transition: color 0.2s;
}
.prod-card:hover .prod-title { color: var(--brand-green-dark); }

.prod-meta { font-size: 0.8rem; color: #64748b; margin-bottom: 1rem; display: flex; align-items: center; gap: 8px; }

.prod-footer {
    margin-top: auto; display: flex; align-items: end; justify-content: space-between;
    border-top: 1px solid #f1f5f9; padding-top: 1rem;
}
.price-box { display: flex; flex-direction: column; }
.price-val { font-size: 1.25rem; font-weight: 800; color: #0f172a; line-height: 1; }
.price-euro { font-size: 0.8rem; color: #94a3b8; font-weight: 500; margin-top: 2px; }
.price-old { font-size: 0.85rem; text-decoration: line-through; color: #cbd5e1; margin-bottom: 2px; }
.price-unit { font-size: 0.75rem; color: #94a3b8; font-weight: 500; }

.btn-icon-action {
    width: 42px; height: 42px; border-radius: 50%; background: #f1f5f9;
    color: var(--brand-dark); display: flex; align-items: center; justify-content: center;
    transition: all 0.2s; border: none;
}
.prod-card:hover .btn-icon-action {
    background: var(--brand-green); color: #fff; transform: scale(1.1);
    box-shadow: 0 4px 15px rgba(166, 207, 57, 0.4);
}

/* Filter Sidebar (AERO Edition) */
.filter-panel {
    position: sticky; 
    top: 100px; /* Just below header */
    max-height: calc(100vh - 120px); /* Prevents sidebar pushing footer */
    overflow-y: auto; /* Internal scroll */
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255,255,255,0.6);
    border-radius: 24px;
    padding: 1.5rem;
    box-shadow: var(--shadow-card);
    z-index: 5;
}

.filter-heading {
    font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em;
    color: var(--brand-gray); font-weight: 800; margin-bottom: 0.8rem;
    display: flex; align-items: center; gap: 8px;
}
.filter-heading::after { content: ''; height: 1px; flex-grow: 1; background: #e2e8f0; }

/* Custom Inputs */
.input-group-aero { position: relative; }
.input-aero {
    background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px;
    padding: 0.8rem 1rem 0.8rem 2.5rem; font-size: 0.9rem; color: var(--brand-dark);
    width: 100%; transition: all 0.2s; font-weight: 500;
}
.input-aero:focus {
    background: #fff; border-color: var(--brand-green);
    box-shadow: 0 0 0 4px rgba(166, 207, 57, 0.1); outline: none;
}
.input-icon {
    position: absolute; left: 12px; top: 50%; transform: translateY(-50%);
    color: #94a3b8; font-size: 1rem; pointer-events: none; transition: color 0.2s;
}
.input-aero:focus + .input-icon { color: var(--brand-green); }

.select-aero {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%2394a3b8' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e");
    background-repeat: no-repeat; background-position: right 1rem center;
    background-size: 16px 12px; appearance: none; padding-left: 1rem;
}

/* Category Tree */
.tree-item { border-bottom: 1px solid rgba(0,0,0,0.03); }
.tree-trigger {
    display: flex; justify-content: space-between; align-items: center;
    padding: 0.8rem 0.5rem; cursor: pointer; border-radius: 8px;
    transition: all 0.2s; font-weight: 700; font-size: 0.9rem; color: var(--brand-dark);
}
.tree-trigger:hover { background: #f1f5f9; padding-left: 1rem; color: var(--brand-green-dark); }
.tree-trigger[aria-expanded="true"] { color: var(--brand-green); }
.tree-icon { font-size: 0.7rem; color: #cbd5e1; transition: transform 0.3s; }
.tree-trigger[aria-expanded="true"] .tree-icon { transform: rotate(180deg); color: var(--brand-green); }

.tree-submenu { padding-left: 1rem; border-left: 2px solid #f1f5f9; margin-left: 0.5rem; margin-bottom: 0.5rem; }
.sub-link {
    display: block; padding: 6px 10px; font-size: 0.85rem; color: #64748b;
    text-decoration: none; transition: all 0.2s; border-radius: 6px; position: relative;
}
.sub-link:hover { color: var(--brand-green-dark); background: #f0fdf4; }
.sub-link::before {
    content: ''; position: absolute; left: -2px; top: 50%; transform: translateY(-50%);
    width: 4px; height: 4px; background: var(--brand-green); border-radius: 50%;
    opacity: 0; transition: opacity 0.2s;
}
.sub-link:hover::before { opacity: 1; }

/* Apply Button */
.btn-filter-apply {
    background: var(--brand-dark); color: #fff; border-radius: 12px;
    padding: 0.8rem; font-weight: 600; letter-spacing: 0.05em;
    transition: all 0.3s; border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.btn-filter-apply:hover {
    background: var(--brand-green); transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(166, 207, 57, 0.3);
}

/* Mobile Floating Button */
.fab-filter {
    background: rgba(255,255,255,0.9); backdrop-filter: blur(10px);
    border: 1px solid rgba(166, 207, 57, 0.3); color: var(--brand-dark);
    font-weight: 700; box-shadow: 0 10px 30px rgba(0,0,0,0.15); transition: transform 0.2s;
}
.fab-filter:active { transform: scale(0.95); }

/* Load More Button */
.btn-load-more {
    background: #fff; border: 1px solid #e2e8f0; color: #64748b; border-radius: 50rem;
    padding: 0.8rem 2rem; font-weight: 600; transition: all 0.3s; box-shadow: var(--shadow-subtle);
}
.btn-load-more:hover {
    border-color: var(--brand-green); color: var(--brand-green-dark);
    transform: translateY(-2px); box-shadow: var(--shadow-float);
}

.offcanvas-bottom-rounded { border-top-left-radius: 24px; border-top-right-radius: 24px; height: 85vh !important; }

/* Responsive Helpers */
@media (max-width: 991px) {
    .desktop-nav-links { display: none !important; }
    .mobile-bottom-nav { display: flex; }
    .fab-scan-container { display: block; }
    .desktop-header { justify-content: space-between; padding: 0 1rem; }
    .container { padding-left: 1rem; padding-right: 1rem; }
    .main-footer { display: none; } 
}

/* =========================================
   6. INTERNAL DASHBOARD STYLES
   ========================================= */
    
/* Action Toolbar (Top Right) */
.action-bar {
    display: flex;
    gap: 8px;
    background: #fff;
    padding: 0.5rem;
    border-radius: 12px;
    border: 1px solid rgba(0,0,0,0.05);
    box-shadow: var(--shadow-subtle);
}
.btn-action {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    width: 80px; height: 70px;
    border: 1px solid #f1f5f9; border-radius: 8px;
    background: #fff; color: var(--brand-dark);
    font-size: 0.65rem; font-weight: 700; text-transform: uppercase; text-align: center;
    transition: all 0.2s;
}
.btn-action i { font-size: 1.2rem; margin-bottom: 4px; color: var(--brand-gray); }
.btn-action:hover { border-color: var(--brand-green); color: var(--brand-green-dark); background: #f0fdf4; }
.btn-action:hover i { color: var(--brand-green); }

/* KPI Cards (Stock Overview) */
.kpi-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 1rem;
    margin-bottom: 1.5rem;
}
.kpi-card {
    background: #fff; border-radius: 16px; padding: 1rem;
    border: 1px solid rgba(0,0,0,0.04); box-shadow: var(--shadow-subtle);
    display: flex; flex-direction: column; justify-content: space-between;
    position: relative; overflow: hidden;
}
.kpi-card::after {
    content: ''; position: absolute; top: 0; right: 0; width: 60px; height: 60px;
    background: linear-gradient(135deg, transparent 50%, rgba(0,0,0,0.02) 50%);
}
.kpi-label { font-size: 0.65rem; text-transform: uppercase; font-weight: 800; color: #94a3b8; letter-spacing: 0.05em; }
.kpi-value { font-family: 'JetBrains Mono', monospace; font-size: 1.5rem; font-weight: 700; color: #0f172a; margin-top: 5px; }

/* Colors for KPI */
.kpi-green .kpi-value { color: var(--brand-green-dark); }
.kpi-red .kpi-value { color: #ef4444; }
.kpi-orange .kpi-value { color: #f59e0b; }

/* Warehouse Table (Modernized) */
.wh-table-container {
    background: #fff; border-radius: 16px; overflow: hidden;
    border: 1px solid rgba(0,0,0,0.04); box-shadow: var(--shadow-subtle);
}
.wh-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: 0.8rem 1.2rem; border-bottom: 1px solid #f1f5f9;
    transition: background 0.1s;
}
.wh-row:last-child { border-bottom: none; }
.wh-row:hover { background: #f8fafc; }

.wh-name { font-weight: 600; font-size: 0.85rem; display: flex; align-items: center; gap: 10px; }
.wh-dot { width: 8px; height: 8px; border-radius: 50%; background: #e2e8f0; }
.wh-dot.active { background: var(--brand-green); box-shadow: 0 0 10px rgba(166, 207, 57, 0.4); }

.wh-val { font-family: 'JetBrains Mono', monospace; font-weight: 700; color: #334155; }

/* Spec Grid Compact */
.spec-compact { font-size: 0.8rem; display: flex; justify-content: space-between; border-bottom: 1px solid #f1f5f9; padding: 6px 0; }
.spec-compact span:first-child { color: #64748b; }
.spec-compact span:last-child { font-weight: 600; color: #0f172a; text-align: right; }

/* Barcode Visual */
.barcode-box {
    background: #fff; padding: 10px; border-radius: 8px; border: 1px solid #e2e8f0;
    text-align: center; margin-top: 1rem;
}
.barcode-font {
    font-family: 'Libre Barcode 39', cursive; /* Google Font if needed, or just image */
    font-size: 2.5rem; line-height: 1; color: #000;
}

/* Tabs AERO */
.nav-tabs-aero { border-bottom: 1px solid #e2e8f0; gap: 20px; }
.nav-tabs-aero .nav-link {
    border: none; background: transparent; color: #64748b; font-weight: 600;
    padding: 1rem 0; margin-bottom: -1px; border-bottom: 2px solid transparent;
}
.nav-tabs-aero .nav-link.active { color: var(--brand-green-dark); border-bottom-color: var(--brand-green); }
.nav-tabs-aero .nav-link:hover { color: var(--brand-dark); }

/* =========================================
   7. LIST INDEX & CARDS (AERO STYLE)
   ========================================= */

/* Search Inputs */
.search-wrapper { position: relative; width: 100%; }
.search-input-hero {
    background: #fff; border: 1px solid rgba(0,0,0,0.1); border-radius: 12px;
    padding: 1rem 3rem 1rem 1.5rem; font-size: 1.1rem; width: 100%;
    box-shadow: 0 4px 15px rgba(0,0,0,0.03); transition: all 0.3s ease;
}
.search-input-hero:focus { outline: none; border-color: var(--brand-green); box-shadow: 0 8px 25px rgba(166, 207, 57, 0.15); }
.search-icon-fixed { position: absolute; right: 20px; top: 50%; transform: translateY(-50%); color: #9ca3af; pointer-events: none; font-size: 1.5rem; }

/* Card Internal Layout */
.card-header-strip {
    padding: 1rem;
    border-bottom: 1px solid #f9fafb;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #ffffff;
}
.card-body-custom {
    padding: 1.25rem;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
}
.location-visual {
    display: flex; align-items: center; gap: 0.5rem; margin: 0.8rem 0;
    color: #374151; font-size: 0.9rem; background: #f8fafc; padding: 8px; border-radius: 8px;
}

/* Stats Grid (With 2-Column Override) */
/* ПРОМЯНА ТУК: 2 колони вместо 3 */
.stats-grid {
    display: grid; grid-template-columns: 1fr 1fr; gap: 1px;
    background: #f3f4f6; border-radius: 8px; overflow: hidden; margin-top: auto; border: 1px solid #f3f4f6;
}
.stat-box { background: #fff; padding: 8px 4px; text-align: center; }
.stat-label { font-size: 0.65rem; text-transform: uppercase; color: #9ca3af; font-weight: 700; }
.stat-val { font-size: 0.95rem; font-weight: 700; color: #374151; }

.badge-date {
    background: #f3f4f6; color: #6b7280; padding: 4px 10px; border-radius: 6px;
    font-size: 0.75rem; font-weight: 600;
}

/* =========================================
   8. AERO DETAIL: NO PACKAGES
   ========================================= */

/* Header & Badges */
.detail-header {
    background: #fff;
    border-radius: 24px;
    padding: 2rem;
    box-shadow: var(--shadow-card);
    border: 1px solid rgba(0,0,0,0.03);
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}
.detail-header::before {
    content: ''; position: absolute; top: 0; left: 0; width: 6px; bottom: 0;
    background: var(--brand-green);
}

.badge-status {
    padding: 0.5rem 1rem; border-radius: 50rem;
    font-weight: 700; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em;
    display: inline-flex; align-items: center; gap: 6px;
}
.status-active { background: #dcfce7; color: #166534; }
.status-dot { width: 8px; height: 8px; background: currentColor; border-radius: 50%; animation: pulse 2s infinite; }

/* Metrics Cards (Juicy Icons) */
.metrics-card {
    background: #fff; border-radius: 20px; padding: 1.5rem; height: 100%;
    border: 1px solid rgba(0,0,0,0.04); box-shadow: 0 4px 15px rgba(0,0,0,0.02);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex; flex-direction: column; justify-content: center;
}
.metrics-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0,0,0,0.06);
    border-color: rgba(166, 207, 57, 0.3);
}
.metric-icon-lg {
    width: 56px; height: 56px; border-radius: 16px;
    display: flex; align-items: center; justify-content: center;
    background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
    color: var(--brand-green-dark);
    margin-bottom: 1rem;
    font-size: 1.75rem;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.8), 0 4px 10px rgba(0,0,0,0.03);
}
.metric-label { font-size: 0.7rem; text-transform: uppercase; font-weight: 800; color: #9ca3af; letter-spacing: 0.05em; margin-bottom: 4px; }
.metric-value { font-size: 1.75rem; font-weight: 800; color: #1f2937; line-height: 1; }
.metric-unit { font-size: 0.9rem; color: #6b7280; font-weight: 600; margin-left: 4px; }

/* Location Visual */
.route-visual-responsive {
    display: flex; align-items: center; gap: 1rem;
    background: #f8fafc; padding: 1rem 1.5rem; border-radius: 16px; margin-top: 1.5rem;
    border: 1px solid #f1f5f9;
}
.wh-point { font-weight: 700; color: #334155; font-size: 0.95rem; }

/* QR Panel */
.qr-panel {
    background: #fff; border: 2px dashed #cbd5e1; border-radius: 20px;
    text-align: center; padding: 1.5rem; height: 100%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    transition: border-color 0.3s;
}
.qr-panel:hover { border-color: var(--brand-green); background: #f0fdf4; }

/* Interactive Table */
.modern-table-card {
    background: #fff; border-radius: 20px;
    border: 1px solid rgba(0,0,0,0.04);
    box-shadow: var(--shadow-subtle);
    overflow: hidden;
}
.table-modern th {
    background: #f8fafc; text-transform: uppercase; font-size: 0.7rem; letter-spacing: 0.08em;
    color: #64748b; font-weight: 800; padding: 1.2rem 1.5rem; border-bottom: 1px solid #e2e8f0;
}
.table-modern td {
    padding: 1.2rem 1.5rem; vertical-align: middle; border-bottom: 1px solid #f1f5f9;
    transition: background 0.1s;
}
.table-row-link { cursor: pointer; }
.table-row-link:hover td { background-color: #f8fafc; }
.table-row-link:hover .prod-name { color: var(--brand-green-dark); }

.qty-pill {
    background: #f1f5f9; padding: 0.4rem 0.8rem; border-radius: 10px;
    font-weight: 700; font-size: 1.1rem; color: #0f172a;
    display: inline-block; min-width: 60px; text-align: center;
}

/* Mobile Adaptations */
@media (max-width: 991px) {
    .detail-header { padding: 1.5rem; }
    .route-visual-responsive { flex-direction: column; align-items: flex-start; gap: 0.8rem; }
    .route-separator { display: none; } 
    .route-visual-responsive > div { width: 100%; padding-left: 0 !important; border: none !important; }
}
/* 
       SCANNER INTERFACE STYLES 
    */
    
    /* 1. Top Info Card */
    .info-card {
        background: #fff;
        border-radius: 16px;
        border: 1px solid rgba(0,0,0,0.02);
        box-shadow: 0 4px 15px rgba(0,0,0,0.03);
    }

    /* 2. The Scanner Console (Hero) */
    .scanner-console {
        background: linear-gradient(145deg, #ffffff 0%, #f9fafb 100%);
        border-radius: 24px;
        border: 1px solid rgba(0,0,0,0.04);
        box-shadow: 0 10px 40px rgba(0,0,0,0.05);
        position: relative;
        overflow: hidden;
    }
    /* Green Accent Line */
    .scanner-console::top {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0;
        height: 4px;
        background: var(--brand-green);
    }

    /* 3. Inputs */
    .form-control-scan {
        background-color: #fff;
        border: 2px solid #f3f4f6;
        border-radius: 12px;
        padding: 1rem 1.2rem;
        font-size: 1.1rem;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
    }
    .form-control-scan:focus {
        border-color: var(--brand-green);
        box-shadow: 0 0 0 4px rgba(166, 207, 57, 0.15);
        background-color: #fff;
    }
    .form-label-custom {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: #6b7280;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    /* 4. Buttons */
    .btn-scan-action {
        background: linear-gradient(135deg, #a6cf39 0%, #7ca323 100%);
        color: #fff !important;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        font-size: 1.1rem;
        letter-spacing: 0.02em;
        box-shadow: 0 4px 15px rgba(166, 207, 57, 0.3);
        transition: all 0.2s;
    }
    .btn-scan-action:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(166, 207, 57, 0.4);
    }
    .btn-scan-action:active {
        transform: scale(0.98);
    }

    /* 5. Preview Card (Result) */
    .preview-card {
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(166, 207, 57, 0.2);
        border-radius: 16px;
        animation: slideDown 0.3s ease-out;
    }
    @keyframes slideDown {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .preview-thumb {
        width: 80px;
        height: 80px;
        object-fit: contain;
        background: #fff;
        border-radius: 10px;
        padding: 5px;
        border: 1px solid #f3f4f6;
    }

    /* 6. Items List (Rows) */
    .item-row {
        background: #fff;
        border-radius: 12px;
        margin-bottom: 0.75rem;
        border: 1px solid transparent;
        box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        transition: all 0.2s;
    }
    .item-row:hover {
        transform: translateX(5px);
        border-color: rgba(166, 207, 57, 0.3);
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    }
    .item-qty-badge {
        background: #f3f4f6;
        color: #1f2937;
        font-weight: 700;
        font-size: 1.2rem;
        padding: 0.25rem 0.75rem;
        border-radius: 8px;
        min-width: 60px;
        text-align: center;
    }
    
    /* 7. Alerts/Badges */
    .alert-soft-danger {
        background: #fef2f2; color: #ef4444; border: 1px solid #fee2e2; border-radius: 12px;
    }
    .alert-soft-warning {
        background: #fffbeb; color: #d97706; border: 1px solid #fef3c7; border-radius: 12px;
    }

    /* 8. Bottom Actions */
    .action-bar {
        background: rgba(255,255,255,0.9);
        border-top: 1px solid rgba(0,0,0,0.05);
        backdrop-filter: blur(5px);
        position: sticky;
        bottom: 0;
        z-index: 10;
        padding: 1rem;
        margin: 0 -1.5rem -1.5rem -1.5rem; /* Negative margins to stretch in container */
        border-radius: 0 0 16px 16px;
    }

    /* =========================================
   STOCK ORDERS DASHBOARD (MODERN)
   ========================================= */

/* 1. KPI / Status Navigation Grid */
/* =========================================
   STOCK ORDERS DASHBOARD (UPDATED)
   ========================================= */

/* 1. Status Navigation (Full Width Grid) */
.kpi-dashboard-grid {
    display: grid;
    /* auto-fit кара елементите да се разпънат по цялата ширина */
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); 
    gap: 1.25rem;
    margin-bottom: 2rem;
    width: 100%; /* Гарантира пълна ширина */
}

.kpi-card {
    background: #fff;
    border: 1px solid rgba(0,0,0,0.04);
    border-radius: 16px;
    padding: 1.25rem 1rem; /* Малко повече въздух вертикално */
    text-decoration: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: var(--shadow-subtle);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    height: 100%; /* За да са еднакво високи */
}

.kpi-card:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-card);
    border-color: rgba(0,0,0,0.08);
}

.kpi-card.active {
    background: #fff;
    border-color: var(--brand-green);
    box-shadow: 0 0 0 2px rgba(166, 207, 57, 0.2);
}

/* Запазваме цветните ленти отгоре */
.kpi-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: #e2e8f0; }
.kpi-card[data-status="new"]::before { background: #94a3b8; }
.kpi-card[data-status="assigned"]::before { background: #3b82f6; }
.kpi-card[data-status="progress"]::before { background: #f59e0b; }
.kpi-card[data-status="ready"]::before { background: #10b981; }
.kpi-card[data-status="problem"]::before { background: #ef4444; }
.kpi-card[data-status="delivered"]::before { background: #6366f1; }

.kpi-count { font-size: 2rem; font-weight: 800; color: var(--brand-dark); line-height: 1; margin-bottom: 6px; }
.kpi-label { font-size: 0.7rem; text-transform: uppercase; font-weight: 700; color: #9ca3af; letter-spacing: 0.05em; text-align: center; }

/* 2. Filter Bar (Full Width Fix) */
.filter-bar {
    background: #fff; 
    border-radius: 12px; 
    padding: 1rem;
    border: 1px solid rgba(0,0,0,0.04); 
    box-shadow: var(--shadow-subtle);
    margin-bottom: 2rem;
    display: flex;
    width: 100%;
}
.order-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-float);
}

/* Status Strip on Left */
.order-card::after {
    content: ''; position: absolute; top: 0; bottom: 0; left: 0; width: 4px;
    background: #e2e8f0; /* Default */
}
.order-card.status-new::after { background: #94a3b8; }
.order-card.status-assigned::after { background: #3b82f6; }
.order-card.status-progress::after { background: #f59e0b; }
.order-card.status-ready::after { background: #10b981; }
.order-card.status-delivered::after { background: #6366f1; }
.order-card.status-problem::after { background: #ef4444; }

.order-header {
    padding: 1rem 1rem 0.5rem 1.5rem; /* More padding left for strip */
    display: flex; justify-content: space-between; align-items: flex-start;
}

.order-id {
    font-family: 'JetBrains Mono', monospace;
    font-weight: 700;
    font-size: 1.1rem;
    color: var(--brand-dark);
}

.order-client {
    font-size: 0.85rem;
    color: #64748b;
    font-weight: 500;
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis;
    max-width: 100%;
}

.order-body {
    padding: 0.5rem 1rem 1rem 1.5rem;
    flex-grow: 1;
}

/* Info Grid inside card */
.order-info-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.8rem;
    margin-bottom: 1rem;
}

.info-item {
    display: flex;
    flex-direction: column;
}
.info-label { font-size: 0.65rem; text-transform: uppercase; color: #9ca3af; font-weight: 700; }
.info-val { font-size: 0.9rem; color: #334155; font-weight: 600; display: flex; align-items: center; gap: 5px; }

/* Assignments Pills */
.assign-pill {
    display: inline-flex; align-items: center; gap: 5px;
    background: #f1f5f9; padding: 4px 8px; border-radius: 6px;
    font-size: 0.75rem; color: #475569; font-weight: 600;
    margin-right: 4px; margin-bottom: 4px;
}

/* Action Toolbar */
.order-actions {
    background: #f8fafc;
    border-top: 1px solid #f1f5f9;
    padding: 0.75rem 1rem 0.75rem 1.5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.5rem;
}

.btn-icon-soft {
    width: 36px; height: 36px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 8px;
    color: #64748b;
    background: #fff;
    border: 1px solid #e2e8f0;
    transition: all 0.2s;
}
.btn-icon-soft:hover {
    background: var(--brand-dark); color: #fff; border-color: var(--brand-dark);
}

/* ERP Tags */
.erp-badge {
    font-size: 0.65rem; font-weight: 800; padding: 2px 6px; border-radius: 4px;
    text-transform: uppercase; cursor: help;
}
.erp-in { background: #dbeafe; color: #1e40af; }
.erp-out { background: #fce7f3; color: #9d174d; }

/* =========================================
   STOCK ORDERS DASHBOARD (REMASTERED)
   ========================================= */

/* 1. Status Navigation (The Top Grid) */
.kpi-dashboard-grid {
    display: flex;           /* Сменяме на Flex за перфектно разпъване */
    flex-wrap: wrap;         /* Позволява пренасяне на малки екрани */
    gap: 1rem;               /* Разстояние между картите */
    margin-bottom: 2rem;
    width: 100%;
}

.kpi-card {
    background: #fff;
    border: 1px solid rgba(0,0,0,0.04);
    border-radius: 16px;
    padding: 1.25rem 0.5rem;
    text-decoration: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: var(--shadow-subtle);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    
    /* MAGICAL FLEX PROPERTIES */
    flex: 1;                 /* Взима цялото налично пространство */
    min-width: 130px;        /* Минимална ширина, за да не се мачкат */
    flex-basis: 0;           /* Гарантира, че всички почват от 0 и се разпъват равно */
}

.kpi-card:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-card);
}

.kpi-card.active {
    background: #fff;
    border-color: var(--brand-green);
    box-shadow: 0 0 0 2px rgba(166, 207, 57, 0.2);
}

/* Status Colors (Top Border) */
.kpi-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: #e2e8f0; }
.kpi-card[data-status="new"]::before { background: #94a3b8; }
.kpi-card[data-status="assigned"]::before { background: #3b82f6; }
.kpi-card[data-status="progress"]::before { background: #f59e0b; }
.kpi-card[data-status="ready"]::before { background: #10b981; }
.kpi-card[data-status="problem"]::before { background: #ef4444; }
.kpi-card[data-status="delivered"]::before { background: #6366f1; }

.kpi-count { font-size: 1.8rem; font-weight: 800; color: var(--brand-dark); line-height: 1; margin-bottom: 4px; }
.kpi-label { font-size: 0.65rem; text-transform: uppercase; font-weight: 700; color: #9ca3af; letter-spacing: 0.05em; }

/* 3. The Card (Light List Style) */
/* Note: We use .modern-card from global CSS, but adding specific overrides if needed */
.order-title {
    font-size: 1.1rem; font-weight: 800; color: var(--brand-dark);
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

.assignee-avatar {
    width: 24px; height: 24px; border-radius: 50%; background: #f1f5f9;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.65rem; font-weight: 700; color: #64748b; border: 1px solid #fff;
    margin-right: -8px; /* Overlap effect */
}

/* =========================================
   MY TASKS (PERSONAL DASHBOARD)
   ========================================= */

/* 1. Personal Header Banner */
.personal-header {
    background: linear-gradient(135deg, #fff 0%, #f8fafc 100%);
    border-radius: 20px;
    padding: 2rem;
    border: 1px solid rgba(0,0,0,0.03);
    box-shadow: var(--shadow-subtle);
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
}

/* Green accent on the right */
.personal-header::after {
    content: '';
    position: absolute;
    right: 0; top: 0; bottom: 0;
    width: 6px;
    background: var(--brand-green);
}

.ph-title { font-size: 1.5rem; font-weight: 800; color: var(--brand-dark); margin: 0; }
.ph-text { color: #64748b; margin: 0; font-size: 1.05rem; }

/* Live Badge */
.live-badge {
    background: rgba(16, 185, 129, 0.1);
    color: #10b981;
    border: 1px solid rgba(16, 185, 129, 0.2);
    padding: 0.35rem 0.8rem;
    border-radius: 50rem;
    font-size: 0.75rem;
    font-weight: 700;
    display: inline-flex;
    align-items: center;
    gap: 6px;
}
.pulse-dot {
    width: 6px; height: 6px; background: currentColor; border-radius: 50%;
    animation: pulse 2s infinite;
}
@keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

/* 2. Personal Stats Grid (Simple Cards) */
.task-stat-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.task-stat-card {
    background: #fff;
    border-radius: 16px;
    padding: 1rem;
    text-align: center;
    border: 1px solid rgba(0,0,0,0.04);
    box-shadow: var(--shadow-subtle);
    transition: transform 0.2s;
    display: flex; flex-direction: column; align-items: center;
}
.task-stat-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-card); }

.task-stat-count { font-size: 1.8rem; font-weight: 800; color: var(--brand-dark); line-height: 1; }
.task-stat-label { font-size: 0.7rem; text-transform: uppercase; font-weight: 700; color: #9ca3af; margin-top: 4px; }

/* Status Line indicators */
.stat-line { height: 3px; width: 30px; margin-top: 8px; border-radius: 2px; }
.line-new { background: #94a3b8; }
.line-assigned { background: #3b82f6; }
.line-progress { background: #f59e0b; }
.line-ready { background: #10b981; }
.line-problem { background: #ef4444; }

/* SMART ACTION GRID (Mobile First) */
.smart-actions-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* 4 в ред на десктоп */
    gap: 12px;
}

/* На мобилно - по-големи и 4 в ред или 2 по 2 ако е тясно */
@media (max-width: 576px) {
    .smart-actions-grid {
        grid-template-columns: repeat(4, 1fr); 
        /* Ако искаш да са по-големи на мобилно, направи го repeat(2, 1fr) */
    }
    .smart-btn span {
        font-size: 0.6rem; /* По-малък шрифт за мобилно */
    }
}

.smart-btn {
    background: #ffffff;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 16px;
    padding: 12px 4px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
    box-shadow: 0 2px 5px rgba(0,0,0,0.02);
    cursor: pointer;
    height: 100%;
}

.smart-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.05);
    border-color: rgba(0,0,0,0.0);
}

.smart-btn:active {
    transform: scale(0.95);
}

.smart-btn span {
    font-size: 0.7rem;
    font-weight: 700;
    color: #64748b;
    text-transform: uppercase;
    line-height: 1.1;
    text-align: center;
}

/* Iconic Backgrounds */
.smart-icon {
    width: 42px;
    height: 42px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    margin-bottom: 4px;
}

.bg-blue-soft { background-color: #eff6ff; }
.bg-green-soft { background-color: #f0fdf4; }
.bg-purple-soft { background-color: #faf5ff; }
.bg-red-soft { background-color: #fef2f2; }
.text-purple { color: #9333ea; }

/* Hover effects for icons */
.smart-btn:hover .bg-blue-soft { background-color: #dbeafe; }
.smart-btn:hover .bg-green-soft { background-color: #dcfce7; }

    /* 
       SCAN CONSOLE PRO STYLES 
    */

    /* 1. Live Scanner HUD (Sci-Fi Style) */
    .scanner-hud {
        background: #0f172a;
        background-image: 
            radial-gradient(at 0% 0%, rgba(166, 207, 57, 0.15) 0px, transparent 50%),
            radial-gradient(at 100% 100%, rgba(56, 189, 248, 0.1) 0px, transparent 50%);
        border-radius: 20px;
        padding: 1.8rem;
        color: #fff;
        position: relative;
        overflow: hidden;
        box-shadow: 0 20px 40px -10px rgba(15, 23, 42, 0.3);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        min-height: 180px;
        border: 1px solid rgba(255,255,255,0.05);
    }
    
    /* Scanning line animation */
    .scan-line {
        position: absolute; top: 0; left: 0; width: 100%; height: 2px;
        background: linear-gradient(90deg, transparent, #a6cf39, transparent);
        opacity: 0.5;
        animation: scan-move 3s linear infinite;
        pointer-events: none;
    }
    @keyframes scan-move { 0% { top: 0; } 100% { top: 100%; } }

    .hud-label { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.15em; color: #64748b; font-weight: 700; }
    .hud-value { 
        font-size: 2.2rem; font-family: 'JetBrains Mono', monospace; font-weight: 700; 
        color: #a6cf39; text-shadow: 0 0 30px rgba(166, 207, 57, 0.3); 
        letter-spacing: -1px;
        transition: color 0.2s;
    }
    
    /* 2. Modern Stats Cards */
    .stat-mini-card {
        background: #fff; 
        border: 1px solid rgba(0,0,0,0.04); 
        border-radius: 20px; 
        padding: 1.5rem 1rem;
        text-align: center; 
        height: 100%; 
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.01);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .stat-mini-card:hover { transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05); }
    .stat-mini-val { font-size: 2rem; font-weight: 800; line-height: 1; margin-bottom: 5px; letter-spacing: -0.03em; }
    .stat-mini-label { font-size: 0.65rem; text-transform: uppercase; color: #94a3b8; font-weight: 800; letter-spacing: 0.05em; }

    /* 3. Striped Progress Bar */
    .progress-track { height: 10px; background: #f1f5f9; border-radius: 20px; overflow: hidden; margin: 1.5rem 0 0.5rem 0; box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); }
    .progress-fill { 
        height: 100%; 
        background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
        background-size: 1rem 1rem;
        background-color: var(--brand-green);
        border-radius: 20px; 
        transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        animation: progress-stripes 1s linear infinite;
    }
    @keyframes progress-stripes { from { background-position: 1rem 0; } to { background-position: 0 0; } }

    /* 4. Fixed Table Layout (The Fix) */
    .table-layout-fixed { table-layout: fixed; width: 100%; }
    
    .table-sticky-header th {
        position: sticky; top: 76px; z-index: 10;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(8px);
        font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.05em; color: #64748b; font-weight: 800;
        padding: 1.2rem 1rem; border-bottom: 1px solid #e2e8f0;
    }
    
    .table-row-modern td { 
        padding: 1rem; vertical-align: middle; border-bottom: 1px solid #f1f5f9; 
        font-size: 0.9rem; color: #334155;
    }
    .table-row-modern { transition: background 0.1s; }
    .table-row-modern:hover { background-color: #f8fafc; }

    /* Row Borders */
    .row-status-ok { border-left: 4px solid #22c55e; background-color: #f0fdf4; }
    .row-status-manual { border-left: 4px solid #eab308; background-color: #fffbeb; }
    .row-status-over { border-left: 4px solid #ef4444; background-color: #fef2f2; }
    .row-status-pending { border-left: 4px solid transparent; }

    /* 5. Terminal Window */
    .terminal-window {
        background: #0f172a; border-radius: 16px; overflow: hidden; margin-top: 2rem;
        border: 1px solid #1e293b; box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }
    .terminal-header {
        background: #1e293b; padding: 0.6rem 1rem; display: flex; align-items: center; gap: 8px;
        border-bottom: 1px solid #334155; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: #94a3b8;
    }
    .log-table { width: 100%; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; color: #94a3b8; }
    .log-table td { padding: 8px 1rem; border-bottom: 1px solid #1e293b; }
    .log-ok { color: #4ade80; } .log-err { color: #f87171; }

    /* 6. Filter Chips */
    .filter-group { display: inline-flex; background: #f1f5f9; padding: 4px; border-radius: 12px; }
    .filter-chip {
        padding: 6px 14px; border-radius: 10px; font-size: 0.8rem; font-weight: 700; 
        color: #64748b; cursor: pointer; transition: all 0.2s; user-select: none; border: 1px solid transparent;
    }
    .filter-chip:hover { color: #334155; background: rgba(255,255,255,0.5); }
    .filter-chip input { display: none; }
    .filter-chip.active { background: #fff; color: var(--brand-dark); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

    /* 
       PREPARATION SCREEN STYLES 
    */

    /* 1. Header & Meta */
    .prep-header {
        background: #fff;
        border-radius: 20px;
        padding: 1.5rem 2rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.02);
        border: 1px solid rgba(0,0,0,0.03);
        margin-bottom: 1.5rem;
    }
    
    /* 2. Stats Cards (KPIs) */
    .prep-stat-card {
        background: #fff;
        border-radius: 16px;
        padding: 1.25rem;
        border: 1px solid rgba(0,0,0,0.04);
        text-align: center;
        height: 100%;
        transition: transform 0.2s;
        box-shadow: 0 2px 5px rgba(0,0,0,0.01);
    }
    .prep-stat-card:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    .stat-title { font-size: 0.75rem; text-transform: uppercase; color: #9ca3af; font-weight: 700; letter-spacing: 0.05em; }
    .stat-value { font-size: 2rem; font-weight: 800; line-height: 1.2; }

    /* 3. Info Grid */
    .info-panel {
        background: #f8fafc;
        border-radius: 12px;
        padding: 1rem;
        border: 1px solid #f1f5f9;
    }
    .info-label { font-size: 0.7rem; text-transform: uppercase; color: #64748b; font-weight: 700; margin-bottom: 4px; }
    .info-content { font-weight: 600; color: #334155; font-size: 0.95rem; }

    /* 4. Scanner Console (The Work Area) */
    .scanner-zone {
        background: linear-gradient(145deg, #ffffff 0%, #fcfcfc 100%);
        border-radius: 20px;
        border: 1px solid rgba(0,0,0,0.06);
        box-shadow: 0 10px 30px rgba(0,0,0,0.03);
        padding: 1.5rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }
    .scanner-zone::before {
        content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px; background: var(--brand-green);
    }
    
    .scan-input-lg {
        height: 3.5rem;
        font-size: 1.2rem;
        border-radius: 12px;
        border: 2px solid #e2e8f0;
        padding-left: 1.5rem;
        transition: all 0.2s;
    }
    .scan-input-lg:focus {
        border-color: var(--brand-green);
        box-shadow: 0 0 0 4px rgba(166, 207, 57, 0.15);
    }
    
    /* 5. Items Table */
    .prep-table th {
        background: #f8fafc;
        font-size: 0.75rem;
        text-transform: uppercase;
        color: #64748b;
        padding: 1rem;
        border-bottom: 2px solid #e2e8f0;
    }
    .prep-table td {
        padding: 1rem;
        vertical-align: middle;
        border-bottom: 1px solid #f1f5f9;
    }
    .row-complete { background-color: #f0fdf4; } /* Light green bg for done items */

    /* 6. Log Console */
    .log-console {
        background: #1e293b;
        border-radius: 12px;
        padding: 1rem;
        max-height: 200px;
        overflow-y: auto;
        font-family: 'Menlo', monospace;
        font-size: 0.85rem;
        color: #e2e8f0;
    }
    .log-item { border-bottom: 1px solid #334155; padding: 4px 0; display: flex; justify-content: space-between; }
    .log-item:last-child { border-bottom: none; }
    .log-success { color: #4ade80; }
    .log-danger { color: #f87171; }
    .log-info { color: #60a5fa; }
/* =========================================
   FINAL FIXES: SCROLL, RESPONSIVE & GEMINI
   ========================================= */

/* 1. FIX: MOBILE SCROLL & LAYOUT */
:root {
    --bottom-nav-height: 74px;
}

/* Глобален padding за body, но по-голям за мобилни */
body {
    padding-bottom: 0;
}

@media (max-width: 991px) {
    body {
        /* Достатъчно, за да не се крие нищо */
        padding-bottom: 100px; 
    }
    /* Физически спейсър, който насилва скрола */
    .mobile-scroll-forcer {
        height: 140px;
        width: 100%;
        display: block;
        pointer-events: none;
    }
}

/* 2. FIX: DESKTOP MENU RESPONSIVENESS (Лаптопи) */
/* Когато екрана е между 992px и 1350px (малък десктоп), намаляваме размерите */
@media (min-width: 992px) and (max-width: 1350px) {
    .nav-link-modern {
        padding: 0.5rem 0.7rem !important; /* По-малко разстояние */
        font-size: 0.8rem !important;      /* По-малък шрифт */
    }
    .nav-link-modern i {
        font-size: 1rem !important;
    }
    .container-fluid {
        padding-left: 10px !important;
        padding-right: 10px !important;
    }
}

/* 3. FIX: GEMINI SEARCH EFFECT (Bottom Border Line) */
.desktop-header {
    background: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: none; /* Махаме стария бордър */
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 1030;
}

/* Самата движеща се линия */
.gemini-loader-line {
    height: 3px;
    width: 100%;
    position: absolute;
    bottom: 0;
    left: 0;
    background: linear-gradient(90deg, #a6cf39, #3b82f6, #9333ea, #a6cf39);
    background-size: 300% 100%;
    animation: gemini-move 4s linear infinite;
    opacity: 0.8;
}

@keyframes gemini-move {
    0% { background-position: 0% 50%; }
    100% { background-position: 100% 50%; }
}

/* 4. STYLE: DESKTOP LINKS (Clean) */
.nav-link-modern {
    border-radius: 50rem;
    padding: 0.6rem 1.2rem;
    color: #64748b;
    font-weight: 600;
    transition: all 0.2s ease;
    white-space: nowrap; /* Забранява пренасянето на нов ред */
}

.nav-link-modern:hover {
    background: #f8fafc;
    color: #0f172a;
}

.nav-link-modern.active {
    background: rgba(166, 207, 57, 0.1);
    color: #365314;
    font-weight: 700;
}
.nav-link-modern.active i { color: #65a30d; }

/* 5. FIX: MOBILE SCAN BUTTON POSITION */
.fab-scan-wrapper {
    position: fixed;
    /* Сваляме го ниско долу, да влезе в дупката на менюто */
    bottom: calc(12px + env(safe-area-inset-bottom)); 
    left: 50%;
    transform: translateX(-50%);
    z-index: 1050;
    filter: drop-shadow(0 4px 10px rgba(0,0,0,0.1));
}

.fab-scan {
    width: 62px;
    height: 62px;
    border-radius: 50%;
    background: #ffffff;
    /* Бял пръстен, за да се слива с менюто */
    border: 4px solid #ffffff; 
    color: #a6cf39; /* Зелена икона */
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.7rem;
    text-decoration: none;
    /* Лек вътрешен акцент */
    box-shadow: inset 0 0 0 1px #e2e8f0; 
    transition: transform 0.1s;
}

.fab-scan:active { transform: scale(0.95); background: #f0fdf4; }

/* 6. MOBILE MENU */
.mobile-bottom-nav {
    height: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom));
    background: rgba(255, 255, 255, 0.95) !important; /* Плътно бяло */
    border-top: 1px solid #f1f5f9;
    z-index: 1040;
    padding-bottom: env(safe-area-inset-bottom);
}

.nav-spacer { width: 66px; }


    /* Стил за визуализацията на етикета */
    .label-preview-container {
        background-color: #f0f2f5;
        border-radius: 12px;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
        border: 1px dashed #ced4da;
    }

    .real-label {
        width: 300px; /* Фиксиран размер за визуализация */
        height: 180px;
        background: white;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        position: relative;
        overflow: hidden;
    }

    .real-label::after {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0; height: 6px;
        background: repeating-linear-gradient(45deg, #eee, #eee 10px, #fff 10px, #fff 20px);
    }

    .label-title {
        font-size: 14px;
        font-weight: 700;
        line-height: 1.2;
        margin-bottom: 5px;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .label-meta {
        font-size: 10px;
        color: #6c757d;
        text-transform: uppercase;
    }

    .label-price-box {
        text-align: right;
    }

    .label-price {
        font-size: 28px;
        font-weight: 800;
        line-height: 1;
        color: #000;
    }

    .label-currency {
        font-size: 12px;
        font-weight: normal;
        vertical-align: super;
    }
