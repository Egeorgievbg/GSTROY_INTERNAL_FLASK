{% extends "base.html" %}
{% block title %}Начало | GSTROY ERP{% endblock %}

{% block content %}

<!-- =============================================================== -->
<!-- DESKTOP ВЕРСИЯ (Видима само на големи екрани: lg и нагоре) -->
<!-- =============================================================== -->
<div class="d-none d-lg-block">
    <!-- 1. HERO КОМАНДЕН ЦЕНТЪР (Твоят подобрен дизайн) -->
    <div class="command-center-hero fade-in">
        <div class="gemini-grid-glow"></div>
        <div class="hero-orb-1"></div>
        <div class="hero-orb-2"></div>
        <div class="row align-items-center position-relative" style="z-index: 2;">
            <div class="col-lg-8">
                <div class="badge-online mb-3">
                    <span class="pulse-dot"></span> Система онлайн
                </div>
                <h1 class="command-title">Здравей, {{ current_user.full_name.split(' ')[0] if current_user.full_name else 'колега' }}!</h1>
                <p class="command-subtitle">
                    Добре дошъл в командния център. Следи наличности, логистика и нареждания в реално време.
                </p>
            </div>
            <div class="col-lg-4 mt-4 mt-lg-0">
                <div class="kpi-widget">
                    <div class="kpi-item">
                        <div class="kpi-value">{{ status_counts.get('assigned', 0) if status_counts else '0' }}</div>
                        <div class="kpi-label">Назначени Задачи</div>
                    </div>
                    <div class="kpi-separator"></div>
                    <div class="kpi-item">
                        <div class="kpi-value text-success">Активно</div>
                        <div class="kpi-label">Готово за Действие</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex flex-wrap gap-3 mt-4 position-relative" style="z-index: 2;">
            <a href="{{ url_for('logistics.simple_list_new') }}" class="btn-hero-action">
                <i class="bi bi-plus-lg"></i>
                <span>Нов списък</span>
            </a>
            <a href="{{ url_for('logistics.receive') }}" class="btn-hero-action">
                <i class="bi bi-qr-code-scan"></i>
                <span>Приеми стока</span>
            </a>
        </div>
    </div>
</div>


<!-- =============================================================== -->
<!-- MOBILE ВЕРСИЯ (Видима само на малки екрани: до lg) -->
<!-- =============================================================== -->
<div class="d-lg-none fade-in">
    <!-- 1. Персонализиран мобилен хедър -->
    <div class="mobile-welcome-bar">
        <div class="d-flex align-items-center gap-3">
            <div class="mobile-avatar">
                {{ current_user.full_name[:1] }}
            </div>
            <div>
                <div class="greeting-sub">Добре дошъл отново,</div>
                <div class="greeting-main">{{ current_user.full_name.split(' ')[0] if current_user.full_name else 'колега' }}!</div>
            </div>
        </div>
        <div class="badge-online-mobile">
            <span class="pulse-dot"></span> Онлайн
        </div>
    </div>

    <!-- 2. Компактна мрежа за статистика и действия -->
    <div class="mobile-actions-grid">
        <!-- Статистика -->
        <div class="mobile-stat-card">
            <div class="stat-value-mobile">{{ status_counts.get('assigned', 0) if status_counts else '0' }}</div>
            <div class="stat-label-mobile">Назначени</div>
        </div>
        <div class="mobile-stat-card">
            <div class="stat-value-mobile text-success">Активно</div>
            <div class="stat-label-mobile">Състояние</div>
        </div>
        <!-- Бързи действия -->
        <a href="{{ url_for('logistics.simple_list_new') }}" class="mobile-action-card">
            <div class="action-icon-mobile icon-green"><i class="bi bi-plus-lg"></i></div>
            <div class="action-label-mobile">Нов списък</div>
        </a>
        <a href="{{ url_for('logistics.receive') }}" class="mobile-action-card">
            <div class="action-icon-mobile icon-blue"><i class="bi bi-box-arrow-in-down"></i></div>
            <div class="action-label-mobile">Приеми стока</div>
        </a>
    </div>
</div>


<!-- =============================================================== -->
<!-- ОБЩА ЧАСТ (Видима и на двете версии) -->
<!-- =============================================================== -->
<div class="fade-in" style="animation-delay: 0.1s;">
    <div class="row g-3 g-lg-4">
        <!-- КОЛОНА 1: СКЛАД -->
        <div class="col-12 col-md-6 col-xl-4">
            <div class="module-header">
                <i class="bi bi-box-seam"></i> Склад
            </div>
            <div class="d-grid gap-3">
                <a href="{{ url_for('products.products') }}" class="module-card-v2">
                    <div class="module-icon-v2 icon-blue"><i class="bi bi-search"></i></div>
                    <div class="module-text">
                        <h5>Продукти</h5>
                        <span>Търсене, наличности и локации.</span>
                    </div>
                    <i class="bi bi-arrow-right-short card-arrow"></i>
                </a>
                <a href="{{ url_for('logistics.simple_list_index') }}" class="module-card-v2">
                    <div class="module-icon-v2 icon-blue"><i class="bi bi-list-check"></i></div>
                    <div class="module-text">
                        <h5>Лайт списъци</h5>
                        <span>Бърза инвентаризация на място.</span>
                    </div>
                    <i class="bi bi-arrow-right-short card-arrow"></i>
                </a>
                <a href="{{ url_for('products.import_products') }}" class="module-card-v2">
                    <div class="module-icon-v2 icon-gray"><i class="bi bi-cloud-upload"></i></div>
                    <div class="module-text">
                        <h5>Импорт</h5>
                        <span>Обновете базата от CSV експорти.</span>
                    </div>
                    <i class="bi bi-arrow-right-short card-arrow"></i>
                </a>
            </div>
        </div>

        <!-- КОЛОНА 2: ЛОГИСТИКА -->
        <div class="col-12 col-md-6 col-xl-4 mt-4 mt-md-0">
            <div class="module-header">
                <i class="bi bi-truck"></i> Логистика
            </div>
            <div class="d-grid gap-3">
                <a href="{{ url_for('logistics.pallet_list') }}" class="module-card-v2">
                    <div class="module-icon-v2 icon-green"><i class="bi bi-boxes"></i></div>
                    <div class="module-text">
                        <h5>Палети</h5>
                        <span>Визуално следене на палетни групи.</span>
                    </div>
                    <i class="bi bi-arrow-right-short card-arrow"></i>
                </a>
                <a href="{{ url_for('logistics.transfers') }}" class="module-card-v2">
                    <div class="module-icon-v2 icon-green"><i class="bi bi-arrow-left-right"></i></div>
                    <div class="module-text">
                        <h5>Трансфери</h5>
                        <span>Планиране на движение между складове.</span>
                    </div>
                    <i class="bi bi-arrow-right-short card-arrow"></i>
                </a>
                <a href="{{ url_for('scanning.scan_task_list') }}" class="module-card-v2">
                    <div class="module-icon-v2 icon-green"><i class="bi bi-upc-scan"></i></div>
                    <div class="module-text">
                        <h5>Scan задачи</h5>
                        <span>Мобилен терминал за сканиране.</span>
                    </div>
                    <i class="bi bi-arrow-right-short card-arrow"></i>
                </a>
            </div>
        </div>

        <!-- КОЛОНА 3: НАРЕЖДАНИЯ -->
        <div class="col-12 col-xl-4 mt-4 mt-xl-0">
            <div class="module-header">
                <i class="bi bi-lightning-charge"></i> Нареждания
            </div>
            <div class="row g-3">
                <div class="col-12 col-md-6 col-xl-12">
                    <a href="{{ url_for('orders.stock_orders_dashboard') }}" class="module-card-v2">
                        <div class="module-icon-v2 icon-orange"><i class="bi bi-kanban"></i></div>
                        <div class="module-text">
                            <h5>Складови поръчки</h5>
                            <span>Контролирайте всички stock orders.</span>
                        </div>
                        <i class="bi bi-arrow-right-short card-arrow"></i>
                    </a>
                </div>
                <div class="col-12 col-md-6 col-xl-12">
                    <a href="{{ url_for('orders.stock_orders_assigned') }}" class="module-card-v2">
                        <div class="module-icon-v2 icon-orange"><i class="bi bi-person-check"></i></div>
                        <div class="module-text">
                            <h5>Присвоени</h5>
                            <span>Вашите текущи задачи.</span>
                        </div>
                        <i class="bi bi-arrow-right-short card-arrow"></i>
                    </a>
                </div>
                <div class="col-12">
                    <a href="{{ url_for('orders.ppp_documents') }}" class="module-card-v2">
                        <div class="module-icon-v2 icon-purple"><i class="bi bi-file-earmark-text"></i></div>
                        <div class="module-text">
                            <h5>PPP документи</h5>
                            <span>Протоколи за подпис и предаване.</span>
                        </div>
                        <i class="bi bi-arrow-right-short card-arrow"></i>
                    </a>
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}